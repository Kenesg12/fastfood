unit CardUnit;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, DB, ADODB, Menus, cxLookAndFeelPainters, cxButtons,
  FIBQuery, pFIBQuery;

type
  TfmCard = class(TForm)
    Edit1: TEdit;
    Label1: TLabel;
    cxButton1: TcxButton;
    tbCard: TpFIBQuery;
    procedure Edit1KeyPress(Sender: TObject; var Key: Char);
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormShow(Sender: TObject);
    procedure cxButton1Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  fmCard: TfmCard;

implementation

uses DMUnit, MainUnit;

{$R *.dfm}

procedure TfmCard.cxButton1Click(Sender: TObject);
begin
Close;
end;

procedure TfmCard.Edit1KeyPress(Sender: TObject; var Key: Char);
begin
if Key=#13 then
 begin
  tbCard.ExecWP([Edit1.Text]);
  if not tbCard.FieldByName('idPerson').IsNull then
   begin
    dm.Current_order.Edit;
    dm.Current_orderIDKLINET.AsInteger:=tbCard.FieldByName('idPerson').AsInteger;
    dm.Current_order.Post;
   end;
  close;
  Edit1.Text:='';
 end;


end;

procedure TfmCard.FormClose(Sender: TObject; var Action: TCloseAction);
begin
Edit1.Text:='';
end;

procedure TfmCard.FormShow(Sender: TObject);
begin
Edit1.SetFocus;
end;

end.
