<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40067,14088125" ReportOptions.Description.Text="" ReportOptions.LastChange="40067,2151141088" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;begin&#13;&#10;With AdoQuery1 do&#13;&#10; begin&#13;&#10;  Active:=false;&#13;&#10;  SQL.Clear;&#13;&#10;  SQL.Add('select pz.dtEndTime as &#34;Дата&#34;, m.vcName as &#34;Услуга&#34;, p.vcName as &#34;Продукт&#34;, c.fkolvo as &#34;кол-во&#34;, ed.cName as &#34;ед.изм&#34;, st.vc_Name as &#34;Станция&#34;, z.iNomer as &#34;Основание&#34;, su.vcName as &#34;Склад&#34;');&#13;&#10;  SQL.add('FROM tbOpenZakaz oz INNER JOIN tbPodzakaz pz ON (oz.idPodzakaz=pz.idPodzakaz) Inner join tbZakazy z ON (z.idZakazy=pz.idZakazy) inner join tbMenu m on (m.idMenu=oz.idMenu) inner join tbCalck c on (c.idMenu=m.idMenu) inner join tbProdukty p on (p.idProdukty=c.idProdukt) inner join tbStrukturaMenu sm on (sm.idStruktura=m.idKategoriya) inner join tbSubek su on (su.idSubekt=sm.idSklad) inner join tbStation st ON (st.id_Station=z.idStation) inner join tbEdizm ed ON (ed.idEdizm=p.idEdizm)');&#13;&#10; &#13;&#10;  SQL.Add('WHERE pz.dtEndTime between :s and :e');                                                                 &#13;&#10;  if (&#60;sklad&#62; &#60;&#62; '&#60;все&#62;') and (&#60;produkt&#62; = '&#60;все&#62;') then&#13;&#10;    SQL.Add('AND su.idSubekt =:skl')    &#13;&#10;  else if (&#60;sklad&#62; &#60;&#62; '&#60;все&#62;') and (&#60;produkt&#62; &#60;&#62; '&#60;все&#62;') then&#13;&#10;    begin        &#13;&#10;     SQL.Add('AND su.idSubekt =:skl');  &#13;&#10;     SQL.Add('AND p.idProdukty =:pr');  &#13;&#10;   end&#13;&#10;  else if (&#60;sklad&#62; = '&#60;все&#62;') and (&#60;produkt&#62; &#60;&#62; '&#60;все&#62;') then            &#13;&#10;     SQL.Add('AND p.idProdukty =:pr');&#13;&#10;                                                    &#13;&#10;  SQL.Add('ORDER BY  pz.dtEndTime, m.vcName, p.vcName, c.fkolvo, ed.cName, st.vc_Name, z.iNomer, su.vcName');   &#13;&#10;  if (&#60;sklad&#62; &#60;&#62; '&#60;все&#62;') then      &#13;&#10;  ParamByName('skl').Value:=&#60;sklad&#62;;&#13;&#10;  if (&#60;produkt&#62; &#60;&#62; '&#60;все&#62;') then            &#13;&#10;  ParamByName('pr').Value:=&#60;produkt&#62;;&#13;&#10;  ParamByName('s').Value:=&#60;start&#62;;&#13;&#10;  ParamByName('e').Value:=&#60;endt&#62;;          &#13;&#10; end;           &#13;&#10;end." PropData="044C65667403F80003546F7003280208446174617365747301010C2C00000020446174615365743D2241444F5175657279312220446174615365744E616D653D2241444F517565727931220000095661726961626C657301010C16000000204E616D653D22204E65772043617465676F7279312200010C0D000000204E616D653D2273746172742200010C0C000000204E616D653D22656E64742200010C0D000000204E616D653D22736B6C61642200010C0F000000204E616D653D2270726F64756B74220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADOQuery Name="ADOQuery1" UserName="ADOQuery1" CloseDataSource="True" FieldAliases.Text="" SQL.Text="select pz.dtEndTime as &#34;Дата&#34;, m.vcName as &#34;Услуга&#34;, p.vcName as &#34;Продукт&#34;, c.fkolvo as &#34;кол-во&#34;, ed.cName as &#34;ед.изм&#34;, st.vc_Name as &#34;Станция&#34;, z.iNomer as &#34;Основание&#34;, su.vcName as &#34;Склад&#34;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                &#13;&#10;FROM tbOpenZakaz oz INNER JOIN tbPodzakaz pz ON (oz.idPodzakaz=pz.idPodzakaz)&#13;&#10;     Inner join tbZakazy z ON (z.idZakazy=pz.idZakazy)&#13;&#10;     inner join tbMenu m on (m.idMenu=oz.idMenu)&#13;&#10;     inner join tbCalck c on (c.idMenu=m.idMenu)&#13;&#10;     inner join tbProdukty p on (p.idProdukty=c.idProdukt)&#13;&#10;     inner join tbStrukturaMenu sm on (sm.idStruktura=m.idKategoriya)&#13;&#10;     inner join tbSubek su on (su.idSubekt=sm.idSklad)                                                                                                                &#13;&#10;     inner join tbStation st ON (st.id_Station=z.idStation)&#13;&#10;     inner join tbEdizm ed ON (ed.idEdizm=p.idEdizm)                       &#13;&#10;ORDER BY  pz.dtEndTime, m.vcName, p.vcName, c.fkolvo, ed.cName, st.vc_Name, z.iNomer, su.vcName                           " CommandTimeout="30" PropData="05704C6566740328010470546F7003C8000A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="15" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Height="64,25201" Left="0" Top="18,89765" Width="1028,03216">
      <TfrxMemoView Name="Memo2" Align="baWidth" Left="0" Top="7,55906" Width="1028,03216" Height="37,7953" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="РџСЂРѕРґР°Р¶Рё РїРѕСЂРѕРґСѓРєС‚РѕРІ (РїРѕРґСЂРѕР±РЅРѕ)&#13;&#10;РЅР° РїРµСЂРёРѕРґ СЃ [start #dhh:mm dd.mm.yyРі] РїРѕ [endt #dhh:mm dd.mm.yyРі]"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="185,19697" Width="1028,03216" ColumnWidth="0" ColumnGap="0" DataSet="ADOQuery1" DataSetName="ADOQuery1" RowCount="0">
      <TfrxMemoView Name="Memo9" Left="20,33859" Top="0" Width="79,37013" Height="18,89765" DataField="Дата" DataSet="ADOQuery1" DataSetName="ADOQuery1" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="dd.mm.yyг." DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ADOQuery1.&#34;Р”Р°С‚Р°&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="99,28355" Top="0" Width="143,62214" Height="18,89765" DataField="Услуга" DataSet="ADOQuery1" DataSetName="ADOQuery1" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="14" ParentFont="False" Text="[ADOQuery1.&#34;РЈСЃР»СѓРіР°&#34;]"/>
      <TfrxMemoView Name="Memo11" Left="242,7718" Top="0" Width="151,1812" Height="18,89765" DataField="Продукт" DataSet="ADOQuery1" DataSetName="ADOQuery1" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="14" ParentFont="False" Text="[ADOQuery1.&#34;РџСЂРѕРґСѓРєС‚&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="393,51206" Top="0" Width="75,5906" Height="18,89765" DataField="кол-во" DataSet="ADOQuery1" DataSetName="ADOQuery1" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="0.###" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="14" HAlign="haCenter" ParentFont="False" Text="[ADOQuery1.&#34;РєРѕР»-РІРѕ&#34;]"/>
      <TfrxMemoView Name="Memo13" Left="469,32313" Top="0" Width="75,5906" Height="18,89765" DataField="ед.изм" DataSet="ADOQuery1" DataSetName="ADOQuery1" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[ADOQuery1.&#34;РµРґ.РёР·Рј&#34;]"/>
      <TfrxMemoView Name="Memo14" Left="544,91373" Top="0" Width="117,16543" Height="18,89765" DataField="Станция" DataSet="ADOQuery1" DataSetName="ADOQuery1" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ADOQuery1.&#34;РЎС‚Р°РЅС†РёСЏ&#34;]"/>
      <TfrxMemoView Name="Memo17" Left="662,41775" Top="0" Width="117,16543" Height="18,89765" DataSet="ADOQuery1" DataSetName="ADOQuery1" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="РїРѕ СЃС‡РµС‚Сѓ в„–[ADOQuery1.&#34;РћСЃРЅРѕРІР°РЅРёРµ&#34;]"/>
      <TfrxMemoView Name="Memo18" Left="779,58318" Top="0" Width="117,16543" Height="18,89765" DataField="Склад" DataSet="ADOQuery1" DataSetName="ADOQuery1" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[ADOQuery1.&#34;РЎРєР»Р°Рґ&#34;]"/>
    </TfrxMasterData>
    <TfrxPageFooter Name="PageFooter1" Height="22,67718" Left="0" Top="309,92146" Width="1028,03216">
      <TfrxMemoView Name="Memo1" Left="944,8825" Top="0" Width="75,5906" Height="18,89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxHeader Name="Header1" Height="18,89765" Left="0" Top="143,62214" Width="1028,03216" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo3" Left="20,55906" Top="0" Width="79,37013" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Р”Р°С‚Р°"/>
      <TfrxMemoView Name="Memo4" Left="99,50402" Top="0" Width="143,62214" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="13" HAlign="haCenter" ParentFont="False" Text="РЈСЃР»СѓРіР°"/>
      <TfrxMemoView Name="Memo5" Left="242,99227" Top="0" Width="151,1812" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РџСЂРѕРґСѓРєС‚"/>
      <TfrxMemoView Name="Memo6" Left="393,953" Top="0" Width="75,5906" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РєРѕР»-РІРѕ"/>
      <TfrxMemoView Name="Memo7" Left="469,5436" Top="0" Width="75,5906" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РµРґ.РёР·Рј"/>
      <TfrxMemoView Name="Memo8" Left="545,1342" Top="0" Width="117,16543" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РЎС‚Р°РЅС†РёСЏ"/>
      <TfrxMemoView Name="Memo15" Left="662,41775" Top="0" Width="117,16543" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РћСЃРЅРѕРІР°РЅРёРµ"/>
      <TfrxMemoView Name="Memo16" Left="779,58318" Top="0" Width="117,16543" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="РЎРєР»Р°Рґ"/>
    </TfrxHeader>
    <TfrxFooter Name="Footer1" Height="22,67718" Left="0" Top="226,7718" Width="1028,03216"/>
  </TfrxReportPage>
</TfrxReport>
