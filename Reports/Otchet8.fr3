<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="5.4.6" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.OutlineVisible="True" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40057.6542930671" ReportOptions.Description.Text="" ReportOptions.LastChange="42949.6040830903" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;   set('sklad', DBLookupComboBox1.KeyValue);&#13;&#10;   set('store', DBLookupComboBox2.KeyValue);&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10; FIBQuery1.Active:=true; FIBQuery1.Locate('ID', -2, 0);&#13;&#10; DBLookupComboBox1.KeyValue:=0;&#13;&#10; FIBQuery2.Active:=true; FIBQuery2.Locate('ID', -2, 0);&#13;&#10; DBLookupComboBox2.KeyValue:=0;&#13;&#10;end." OnReportPrint="frxReport1OnReportPrint">
  <Datasets>
    <item DataSet="FDQuery1" DataSetName="IBXQuery1"/>
    <item DataSet="FIBQuery1" DataSetName="FIBQuery1"/>
    <item DataSet="FIBQuery2" DataSetName="FIBQuery2"/>
  </Datasets>
  <Variables>
    <item Name=" New Category1"/>
    <item Name="start"/>
    <item Name="endt"/>
    <item Name="sklad"/>
    <item Name="store"/>
  </Variables>
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxFDQuery Name="FDQuery1" UserName="IBXQuery1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select p.name as vcname, sum(-coalesce(s.amount, 0)) as sebest, sum(-s.kolvo) as kolvo,&#13;&#10;sum(coalesce(s.amount_sales, 0)) as summa, 0 as margin&#13;&#10;from resources s&#13;&#10;inner join dimension d on(s.pid = d.id)&#13;&#10;inner join d_product p on(d.idproduct = p.id)&#13;&#10;inner join d_lines l on(s.idosnov = l.uid)&#13;&#10;inner join documents c on(l.iddocument = c.uid)&#13;&#10;left join product_classificators k on(p.id = k.idproduct) and k.idclassificators = iif(:su = 0, k.idclassificators, :su)&#13;&#10;where s.dt between :s and :e&#13;&#10;and d.idsubekt = iif(:ss = 0, d.idsubekt, :ss)&#13;&#10;and c.operacii_type = 2&#13;&#10;group by p.name&#13;&#10;  " PropData="05704C6566740388010470546F7002780A506172616D65746572730101063C204E616D653D227375222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B736B6C6164262336323B220001063C204E616D653D227375222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B736B6C6164262336323B220001063C204E616D653D2273222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22262336303B7374617274262336323B220001063B204E616D653D2265222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22262336303B656E6474262336323B220001063C204E616D653D227373222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B73746F7265262336323B220001063C204E616D653D227373222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B73746F7265262336323B220000"/>
    <TfrxFDQuery Name="FIBQuery1" UserName="FIBQuery1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select id, name&#13;&#10;from classificators&#13;&#10;union&#13;&#10;select 0, 'ВСЕ'&#13;&#10;from rdb$database;  " PropData="05704C6566740324020470546F7002740A506172616D65746572730100"/>
    <TfrxFDQuery Name="FIBQuery2" UserName="FIBQuery2" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select id, name&#13;&#10;from tbSubekt&#13;&#10;where id &#62; 0&#13;&#10;union&#13;&#10;select 0, 'ВСЕ'&#13;&#10;from rdb$database;  " PropData="05704C6566740384020470546F70026C0A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="15" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="113.10235" Left="0" Top="16" Width="699.21305">
      <TfrxMemoView Name="Memo2" Align="baWidth" Left="0" Top="15.11812" Width="699.21305" Height="26.17316" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="536870911" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Отчет по полученной прибыли"/>
      <TfrxMemoView Name="Memo5" Align="baWidth" Left="0" Top="41.57483" Width="699.21305" Height="18.89765" Font.Charset="1" Font.Color="536870911" Font.Height="-13" Font.Name="Arial" Font.Style="1" ParentFont="False" VAlign="vaCenter" Text="Период: с [start #dhh:mm dd.mm.yyyyг.] по [endt #dhh:mm dd.mm.yyyyг.]"/>
      <TfrxMemoView Name="Memo6" Align="baWidth" Left="0" Top="62.25201" Width="699.21305" Height="18.89765" Font.Charset="1" Font.Color="536870911" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Width="2" ParentFont="False" VAlign="vaCenter" Text="Классификатор: &#34;[FIBQuery1.&#34;NAME&#34;]&#34;"/>
      <TfrxMemoView Name="Memo8" Left="408.18924" Top="1.66141" Width="291.02381" Height="11.33859" Font.Charset="1" Font.Color="536870911" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Width="2" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Date] [Time]"/>
      <TfrxMemoView Name="Memo21" Align="baWidth" Left="0" Top="87.48825" Width="699.21305" Height="18.89765" Font.Charset="1" Font.Color="536870911" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="8" Frame.Width="2" ParentFont="False" VAlign="vaCenter" Text="Склад: &#34;[FIBQuery2.&#34;NAME&#34;]&#34;"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="22.67718" Left="0" Top="284" Width="699.21305">
      <TfrxMemoView Name="Memo1" Left="623.62245" Top="0" Width="75.5906" Height="18.89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="18.89765" Left="0" Top="204" Width="699.21305" ColumnWidth="0" ColumnGap="0" DataSet="FDQuery1" DataSetName="IBXQuery1" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo19" Left="0" Top="0" Width="30.23624" Height="18.89765" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[Line#]"/>
      <TfrxMemoView Name="Memo20" Left="30.23624" Top="0" Width="170.07885" Height="18.89765" StretchMode="smMaxHeight" DataField="VCNAME" DataSet="FDQuery1" DataSetName="IBXQuery1" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" VAlign="vaCenter" Text="[IBXQuery1.&#34;VCNAME&#34;]"/>
      <TfrxMemoView Name="Memo22" Left="200.31509" Top="0" Width="60.47248" Height="18.89765" StretchMode="smMaxHeight" DataField="KOLVO" DataSet="FDQuery1" DataSetName="IBXQuery1" DisplayFormat.FormatStr="%2.3f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[IBXQuery1.&#34;KOLVO&#34;]"/>
      <TfrxMemoView Name="Memo24" Left="260.78757" Top="0" Width="71.81107" Height="18.89765" StretchMode="smMaxHeight" DataSet="FDQuery1" DataSetName="IBXQuery1" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[&#60;IBXQuery1.&#34;SEBEST&#34;&#62;/&#60;IBXQuery1.&#34;KOLVO&#34;&#62;]"/>
      <TfrxMemoView Name="Memo25" Left="332.59864" Top="0" Width="71.81107" Height="18.89765" StretchMode="smMaxHeight" DataField="SEBEST" DataSet="FDQuery1" DataSetName="IBXQuery1" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[IBXQuery1.&#34;SEBEST&#34;]"/>
      <TfrxMemoView Name="Memo26" Left="404.40971" Top="0" Width="64.25201" Height="18.89765" StretchMode="smMaxHeight" DataSet="FDQuery1" DataSetName="IBXQuery1" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[&#60;IBXQuery1.&#34;SUMMA&#34;&#62;/&#60;IBXQuery1.&#34;KOLVO&#34;&#62;]"/>
      <TfrxMemoView Name="Memo27" Left="468.66172" Top="0" Width="64.25201" Height="18.89765" StretchMode="smMaxHeight" DataField="SUMMA" DataSet="FDQuery1" DataSetName="IBXQuery1" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[IBXQuery1.&#34;SUMMA&#34;]"/>
      <TfrxMemoView Name="Memo28" Left="608.50433" Top="0" Width="90.70872" Height="18.89765" StretchMode="smMaxHeight" DataSet="FDQuery1" DataSetName="IBXQuery1" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[&#60;IBXQuery1.&#34;SUMMA&#34;&#62;-&#60;IBXQuery1.&#34;SEBEST&#34;&#62;-&#60;IBXQuery1.&#34;MARGIN&#34;&#62;]"/>
      <TfrxMemoView Name="Memo15" Left="532.91373" Top="0" Width="75.5906" Height="18.89765" StretchMode="smMaxHeight" DataField="MARGIN" DataSet="FDQuery1" DataSetName="IBXQuery1" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[IBXQuery1.&#34;MARGIN&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Height="37.7953" Left="0" Top="148" Width="699.21305">
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="30.23624" Height="37.7953" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="№"/>
      <TfrxMemoView Name="Memo4" Left="30.23624" Top="0" Width="170.07885" Height="37.7953" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Наименование"/>
      <TfrxMemoView Name="Memo7" Left="200.31509" Top="0" Width="60.47248" Height="37.7953" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Кол-во"/>
      <TfrxMemoView Name="Memo9" Left="260.78757" Top="0" Width="143.62214" Height="18.89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" Text="Себестоимость"/>
      <TfrxMemoView Name="Memo10" Left="260.78757" Top="18.89765" Width="71.81107" Height="18.89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" Text="Цена"/>
      <TfrxMemoView Name="Memo11" Left="332.59864" Top="18.89765" Width="71.81107" Height="18.89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" Text="Сумма"/>
      <TfrxMemoView Name="Memo12" Left="404.40971" Top="0" Width="128.50402" Height="18.89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" Text="Реализация"/>
      <TfrxMemoView Name="Memo13" Left="404.40971" Top="18.89765" Width="64.25201" Height="18.89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" Text="Цена"/>
      <TfrxMemoView Name="Memo14" Left="468.66172" Top="18.89765" Width="64.25201" Height="18.89765" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" Text="Сумма"/>
      <TfrxMemoView Name="Memo16" Left="608.50433" Top="0" Width="90.70872" Height="37.7953" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Сумма &#13;&#10;прибыли"/>
      <TfrxMemoView Name="Memo17" Left="532.91373" Top="0" Width="75.5906" Height="37.7953" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Сумма &#13;&#10;обслуж."/>
    </TfrxHeader>
    <TfrxFooter Name="Footer1" FillType="ftBrush" FillGap.Top="0" FillGap.Left="0" FillGap.Bottom="0" FillGap.Right="0" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Height="18.89765" Left="0" ParentFont="False" Top="244" Width="699.21305">
      <TfrxMemoView Name="Memo31" Left="328.81911" Top="0" Width="75.5906" Height="18.89765" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" Text="[SUM(&#60;IBXQuery1.&#34;SEBEST&#34;&#62;,MasterData1) #n%2,2m]"/>
      <TfrxMemoView Name="Memo32" Left="457.32313" Top="0" Width="75.5906" Height="18.89765" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" Text="[SUM(&#60;IBXQuery1.&#34;SUMMA&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo33" Left="608.50433" Top="0" Width="90.70872" Height="18.89765" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" Text="[SUM(&#60;IBXQuery1.&#34;SUMMA&#34;&#62;-&#60;IBXQuery1.&#34;SEBEST&#34;&#62;-&#60;IBXQuery1.&#34;MARGIN&#34;&#62;,MasterData1)]"/>
      <TfrxMemoView Name="Memo18" Left="532.91373" Top="0" Width="75.5906" Height="18.89765" DisplayFormat.FormatStr="%2.2m" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="-16777208" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" Fill.BackColor="15790320" HAlign="haCenter" ParentFont="False" Text="[SUM(&#60;IBXQuery1.&#34;MARGIN&#34;&#62;,MasterData1)]"/>
    </TfrxFooter>
  </TfrxReportPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Выберите необходимые параметры" Height="189" ClientHeight="162" Left="324" Top="141" Width="335" ClientWidth="327">
    <TfrxButtonControl Name="Button1" Left="64" Top="128" Width="75" Height="25" ShowHint="True" Caption="ОК" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="168" Top="128" Width="75" Height="25" ShowHint="True" Caption="Отмена" ModalResult="2"/>
    <TfrxDBLookupComboBox Name="DBLookupComboBox1" Left="40" Top="36" Width="261" Height="21" ShowHint="True" AutoOpenDataSet="True" DataSet="FIBQuery1" DataSetName="FIBQuery1" ListField="NAME" KeyField="ID" DropDownWidth="0" DropDownRows="7"/>
    <TfrxLabelControl Name="Label1" Left="41" Top="20" Width="89" Height="13" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" ParentFont="False" ShowHint="True" Caption="Классификатор" Color="-16777201"/>
    <TfrxDBLookupComboBox Name="DBLookupComboBox2" Left="40" Top="88" Width="261" Height="21" ShowHint="True" AutoOpenDataSet="True" DataSet="FIBQuery2" DataSetName="FIBQuery2" ListField="NAME" KeyField="ID" DropDownWidth="0" DropDownRows="7"/>
    <TfrxLabelControl Name="Label2" Left="41" Top="72" Width="37" Height="13" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="1" ParentFont="False" ShowHint="True" Caption="Склад" Color="-16777201"/>
  </TfrxDialogPage>
</TfrxReport>
