<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.3" DotMatrixReport="False" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40059,8101095833" ReportOptions.Description.Text="" ReportOptions.LastChange="40066,8105571759" ScriptLanguage="PascalScript" ScriptText.Text="&#13;&#10;procedure Memo10OnAfterData(Sender: TfrxComponent);&#13;&#10;begin                                                                                                                                                                       &#13;&#10;  if NQ.Locate('idProdukty;idSubekt',[PQ.FieldByName('idProdukty').asstring,PQ.FieldByName('idSubekt').AsString],0)then                  &#13;&#10;  Memo11.Text:=FormatFloat('0.###',NQ.FieldByName('kolvo').asFloat)                &#13;&#10;  else Memo11.Text:='0';                         &#13;&#10;  if PrQ.Locate('idProdukty;idSubekt',[PQ.FieldByName('idProdukty').asstring,PQ.FieldByName('idSubekt').AsString],0)then                  &#13;&#10;  Memo7.Text:=FormatFloat('0.###',PrQ.FieldByName('kolvo').asFloat)              &#13;&#10;  else Memo7.Text:='0';&#13;&#10;  if RaQ.Locate('idProdukty;idSubekt',[PQ.FieldByName('idProdukty').asstring,PQ.FieldByName('idSubekt').AsString],0)then                  &#13;&#10;  Memo8.Text:=FormatFloat('0.###',RaQ.FieldByName('kolvo').asFloat)          &#13;&#10;  else Memo8.Text:='0';&#13;&#10;  if KQ.Locate('idProdukty;idSubekt',[PQ.FieldByName('idProdukty').asstring,PQ.FieldByName('idSubekt').AsString],0)then                  &#13;&#10;  Memo14.Text:=FormatFloat('0.###',KQ.FieldByName('kolvo').asFloat)          &#13;&#10;  else Memo14.Text:='0';                                    &#13;&#10;end;&#13;&#10;&#13;&#10;begin   &#13;&#10;                                    &#13;&#10; With PQ do&#13;&#10; begin&#13;&#10;  Active:=false;&#13;&#10;  SQL.Clear;&#13;&#10;  SQL.Add('select p.vcName as produkt, p.fkod, p.idProdukty, s.vcName as sklad, n.idSubekt');&#13;&#10;  SQL.Add('FROM tbSklad n INNER JOIN tbPRodukty p ON (n.idProdukty=p.idProdukty) INNER JOIN tbSubek s ON (s.idSubekt=n.idSubekt)');&#13;&#10;             &#13;&#10;  if (&#60;sklad&#62; &#60;&#62; '&#60;âñå&#62;') and (&#60;produkt&#62; = '&#60;âñå&#62;') then&#13;&#10;    SQL.Add('WHERE n.idSubekt =:skl')    &#13;&#10;  else if (&#60;sklad&#62; &#60;&#62; '&#60;âñå&#62;') and (&#60;produkt&#62; &#60;&#62; '&#60;âñå&#62;') then&#13;&#10;    begin        &#13;&#10;     SQL.Add('WHERE n.idSubekt =:skl');  &#13;&#10;     SQL.Add('AND p.idProdukty =:pr');  &#13;&#10;   end&#13;&#10;  else if (&#60;sklad&#62; = '&#60;âñå&#62;') and (&#60;produkt&#62; &#60;&#62; '&#60;âñå&#62;') then            &#13;&#10;     SQL.Add('WHERE p.idProdukty =:pr');             &#13;&#10;  SQL.Add('GROUP BY p.vcName, p.fkod, p.idProdukty, s.vcName, n.idSubekt');&#13;&#10;  SQL.Add('ORDER BY s.vcName');   &#13;&#10;  if (&#60;sklad&#62; &#60;&#62; '&#60;âñå&#62;') then      &#13;&#10;  ParamByName('skl').Value:=&#60;sklad&#62;;&#13;&#10;  if (&#60;produkt&#62; &#60;&#62; '&#60;âñå&#62;') then            &#13;&#10;  ParamByName('pr').Value:=&#60;produkt&#62;;         &#13;&#10;  Active:=true;&#13;&#10; end;&#13;&#10;&#13;&#10;{ With NQ do&#13;&#10;  begin                 &#13;&#10;   Active:=true;&#13;&#10;   SQL.clear;&#13;&#10;   SQL.Add('select SUM(n.fKolvo) as kolvo, p.idProdukty, n.idSubekt');&#13;&#10;     &#13;&#10;  end;}          &#13;&#10;&#13;&#10;&#13;&#10;&#13;&#10;    &#13;&#10; NQ.Active:=true;                                   &#13;&#10; PrQ.Active:=true;&#13;&#10; RaQ.Active:=true;&#13;&#10; KQ.Active:=true;    &#13;&#10;end." PropData="044C65667403F80003546F7003280208446174617365747301010C1E00000020446174615365743D224B512220446174615365744E616D653D224B512200010C1E00000020446174615365743D224E512220446174615365744E616D653D224E512200010C2000000020446174615365743D225072512220446174615365744E616D653D225072512200010C2000000020446174615365743D225261512220446174615365744E616D653D225261512200010C1E00000020446174615365743D2250512220446174615365744E616D653D225051220000095661726961626C657301010C16000000204E616D653D22204E65772043617465676F7279312200010C0D000000204E616D653D2273746172742200010C0C000000204E616D653D22656E64742200010C0F000000204E616D653D2270726F64756B742200010C0D000000204E616D653D22736B6C6164220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADOQuery Name="NQ" UserName="NQ" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT SUM(n.fKolvo) as kolvo, p.idProdukty, n.idSubekt                                                                                                 &#13;&#10;FROM&#13;&#10;    tbSklad n&#13;&#10;    INNER JOIN tbPRodukty p ON (n.idProdukty=p.idProdukty)&#13;&#10;WHERE n.dtTime &#60; :s                                                                 &#13;&#10;GROUP BY p.idProdukty, n.idSubekt                                                    &#13;&#10;  " CommandTimeout="30" PropData="05704C656674032C010470546F7003F0000A506172616D657465727301010C3C000000204E616D653D2273222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22262336303B7374617274262336323B220000"/>
    <TfrxADOQuery Name="RaQ" UserName="RaQ" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT p.idProdukty, SUM(n.fKolvo) as kolvo, n.idSubekt                                                                    &#13;&#10;FROM&#13;&#10;    tbSklad n&#13;&#10;    INNER JOIN tbPRodukty p ON (n.idProdukty=p.idProdukty)  &#13;&#10;Where n.fKolvo&#60;0                                       &#13;&#10;and n.dtTime between :s and :e      &#13;&#10;GROUP BY p.idProdukty, n.idSubekt                          " CommandTimeout="30" PropData="05704C6566740304020470546F7003EC000A506172616D657465727301010C3C000000204E616D653D2273222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22262336303B7374617274262336323B2200010C3B000000204E616D653D2265222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22262336303B656E6474262336323B220000"/>
    <TfrxADOQuery Name="KQ" UserName="KQ" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT SUM(n.fKolvo) as kolvo, p.idProdukty, n.idSubekt                                                                                                 &#13;&#10;FROM&#13;&#10;    tbSklad n&#13;&#10;    INNER JOIN tbPRodukty p ON (n.idProdukty=p.idProdukty)&#13;&#10;WHERE n.dtTime &#60; :e            &#13;&#10;GROUP BY p.idProdukty, n.idSubekt                                                    &#13;&#10;  " CommandTimeout="30" PropData="05704C6566740370020470546F7003EC000A506172616D657465727301010C3B000000204E616D653D2265222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22262336303B656E6474262336323B220000"/>
    <TfrxADOQuery Name="PrQ" UserName="PrQ" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT p.idProdukty, SUM(n.fKolvo) as kolvo, n.idSubekt&#13;&#10;FROM&#13;&#10;    tbSklad n&#13;&#10;    INNER JOIN tbPRodukty p ON (n.idProdukty=p.idProdukty)  &#13;&#10;Where n.fKolvo &#62; 0                                       &#13;&#10;and n.dtTime between :s and :e      &#13;&#10;GROUP BY p.idProdukty, n.idSubekt    " CommandTimeout="30" PropData="05704C6566740390010470546F7003F4000A506172616D657465727301010C3C000000204E616D653D2273222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22262336303B7374617274262336323B2200010C3B000000204E616D653D2265222044617461547970653D2266744461746554696D65222045787072657373696F6E3D22262336303B656E6474262336323B220000"/>
    <TfrxADOQuery Name="PQ" UserName="PQ" CloseDataSource="True" FieldAliases.Text="" SQL.Text="SELECT p.vcName as produkt, p.fkod, p.idProdukty, s.vcName as sklad, n.idSubekt                                                                                                                                                                                                                                         &#13;&#10;FROM&#13;&#10;    tbSklad n&#13;&#10;    INNER JOIN tbPRodukty p ON (n.idProdukty=p.idProdukty)&#13;&#10;    INNER JOIN tbSubek s ON (s.idSubekt=n.idSubekt)&#13;&#10;&#13;&#10;GROUP BY p.vcName, p.fkod, p.idProdukty, s.vcName, n.idSubekt                                                                                                                                 &#13;&#10;ORDER BY s.vcName&#13;&#10;  " CommandTimeout="30" PropData="05704C65667403B8000470546F7003E8000A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Height="52,91342" Left="0" Top="18,89765" Width="718,1107">
      <TfrxMemoView Name="Memo2" Align="baWidth" Left="0" Top="6,11812" Width="718,1107" Height="41,57483" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Arial" Font.Style="1" HAlign="haCenter" ParentFont="False" Text="Ð”Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ñ‚Ð¾Ð²Ð°Ñ€Ð° (ÐºÑ€Ð°Ñ‚ÐºÐ¾)&#13;&#10;Ð½Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ñ [start #dhh:mm dd.mm.yyÐ³] Ð¿Ð¾ [endt #dhh:mm dd.mm.yyÐ³]"/>
    </TfrxReportTitle>
    <TfrxPageFooter Name="PageFooter1" Height="22,67718" Left="0" Top="328,81911" Width="718,1107">
      <TfrxMemoView Name="Memo1" Left="634,96104" Top="0" Width="75,5906" Height="18,89765" HAlign="haRight" Text="[Page#]"/>
    </TfrxPageFooter>
    <TfrxMasterData Name="MasterData1" Height="18,89765" Left="0" Top="204,09462" Width="718,1107" ColumnWidth="0" ColumnGap="0" DataSet="PQ" DataSetName="PQ" RowCount="0">
      <TfrxMemoView Name="Memo8" Left="472,44125" Top="0,118120000000005" Width="94,48825" Height="18,89765" DataSet="PQ" DataSetName="PQ" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="0.###" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo9" Left="37,7953" Top="0,118120000000005" Width="56,69295" Height="18,89765" DataField="fkod" DataSet="PQ" DataSetName="PQ" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[PQ.&#34;fkod&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="94,48825" Top="0,118120000000005" Width="188,9765" Height="18,89765" OnAfterData="Memo10OnAfterData" DataField="produkt" DataSet="PQ" DataSetName="PQ" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[PQ.&#34;produkt&#34;]"/>
      <TfrxMemoView Name="Memo11" Left="283,46475" Top="0,118120000000005" Width="94,48825" Height="18,89765" DataSet="PQ" DataSetName="PQ" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="%2.2f" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo14" Left="566,9295" Top="0,118120000000005" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," DisplayFormat.FormatStr="0.###" DisplayFormat.Kind="fkNumeric" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo7" Left="377,953" Top="0" Width="94,48825" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader1" Height="49,13389" Left="0" Top="132,28355" Width="718,1107" Condition="PQ.&#34;sklad&#34;">
      <TfrxMemoView Name="Memo15" Left="15,11812" Top="0" Width="646,29963" Height="18,89765" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="8" ParentFont="False" Text="[PQ.&#34;sklad&#34;]"/>
      <TfrxMemoView Name="Memo3" Left="37,7953" Top="30,23624" Width="56,69295" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="ÐºÐ¾Ð´"/>
      <TfrxMemoView Name="Memo4" Left="94,26778" Top="30,23624" Width="188,9765" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Ð½Ð°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ"/>
      <TfrxMemoView Name="Memo5" Left="283,46475" Top="30,23624" Width="94,48825" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Ð½Ð° Ð½Ð°Ñ‡Ð°Ð»Ð¾"/>
      <TfrxMemoView Name="Memo6" Left="377,953" Top="30,23624" Width="94,48825" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Ð¿Ñ€Ð¸Ñ…Ð¾Ð´"/>
      <TfrxMemoView Name="Memo12" Left="472,44125" Top="30,23624" Width="94,48825" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Ñ€Ð°ÑÑ…Ð¾Ð´"/>
      <TfrxMemoView Name="Memo13" Left="566,9295" Top="30,23624" Width="94,48825" Height="18,89765" Color="15790320" DisplayFormat.DecimalSeparator="," Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Ð½Ð° ÐºÐ¾Ð½ÐµÑ†"/>
    </TfrxGroupHeader>
    <TfrxGroupFooter Name="GroupFooter1" Height="22,67718" Left="0" Top="245,66945" Width="718,1107"/>
  </TfrxReportPage>
</TfrxReport>
